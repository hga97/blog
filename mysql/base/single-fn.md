数据处理函数又被称为单行处理函数，特点:输入一行输出一行  

| 函数              |  说明            |
|  ----            | ----             |
| Lower            | 转换小写           |
| upper            | 转换大写           |
| **substr**           | 取子串(substr('被截取的字符串', '起始下标', '截取的长度')) |
| length           | 取长度            |
| **trim**             | 去空格            |
| str_to_date      | 将字符串转换成日期      |
| date_format      | 格式化日期            |
| format           | 设置千分位            |
| round            | 四舍五入              |
| rand()           | 生成随机数            |
| **Ifnull**           | 可以将 null 转换成一个具体值   |

### lower

查询员工，将员工姓名全部转换成小写
```bash
select lower(ename) from emp;

+--------------+
| lower(ename) |
+--------------+
| smith        |
| allen        |
| ward         |
| jones        |
| martin       |
| blake        |
| clark        |
| scott        |
| king         |
| turner       |
| adams        |
| james        |
| ford         |
| miller       |
+--------------+

```

### upper

查询job为manager的员工
```bash
select * from emp where job = upper('manager');

+-------+-------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+-------+---------+------+------------+---------+------+--------+
|  7566 | JONES | MANAGER | 7839 | 1981-04-02 | 2975.00 | NULL |     20 |
|  7698 | BLAKE | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL |     30 |
|  7782 | CLARK | MANAGER | 7839 | 1981-06-09 | 2450.00 | NULL |     10 |
+-------+-------+---------+------+------------+---------+------+--------+

```

### substr

查询姓名以 M 开头所有的员工
```bash
select * from emp where substr(ename, 1, 1) = upper('m');

+-------+--------+----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB      | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+----------+------+------------+---------+---------+--------+
|  7654 | MARTIN | SALESMAN | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7934 | MILLER | CLERK    | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
+-------+--------+----------+------+------------+---------+---------+--------+

```

### length

取得员工姓名长度为5的
```bash
select * from emp where length(ename) = 5;

+-------+-------+----------+------+------------+---------+--------+--------+
| EMPNO | ENAME | JOB      | MGR  | HIREDATE   | SAL     | COMM   | DEPTNO |
+-------+-------+----------+------+------------+---------+--------+--------+
|  7369 | SMITH | CLERK    | 7902 | 1980-12-17 |  800.00 |   NULL |     20 |
|  7499 | ALLEN | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 |     30 |
|  7566 | JONES | MANAGER  | 7839 | 1981-04-02 | 2975.00 |   NULL |     20 |
|  7698 | BLAKE | MANAGER  | 7839 | 1981-05-01 | 2850.00 |   NULL |     30 |
|  7782 | CLARK | MANAGER  | 7839 | 1981-06-09 | 2450.00 |   NULL |     10 |
|  7788 | SCOTT | ANALYST  | 7566 | 1987-04-19 | 3000.00 |   NULL |     20 |
|  7876 | ADAMS | CLERK    | 7788 | 1987-05-23 | 1100.00 |   NULL |     20 |
|  7900 | JAMES | CLERK    | 7698 | 1981-12-03 |  950.00 |   NULL |     30 |
+-------+-------+----------+------+------------+---------+--------+--------+

```

### trim

**trim 会去首尾空格，不会去除中间的空格**

取得工作岗位为 manager 的所有员工
```bash
select * from emp where job = trim(' manager ');

+-------+-------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+-------+---------+------+------------+---------+------+--------+
|  7566 | JONES | MANAGER | 7839 | 1981-04-02 | 2975.00 | NULL |     20 |
|  7698 | BLAKE | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL |     30 |
|  7782 | CLARK | MANAGER | 7839 | 1981-06-09 | 2450.00 | NULL |     10 |
+-------+-------+---------+------+------------+---------+------+--------+

```

### str_to_date

**str_to_date 可以将字符串转换成日期，具体格式 str_to_date (字符串，匹配格式)**

查询 1981-02-20 入职的员工(第一种方法，与数据库的格式匹配上)
```bash
select * from emp where HIREDATE = '1981-02-20';

+-------+-------+----------+------+------------+---------+--------+--------+
| EMPNO | ENAME | JOB      | MGR  | HIREDATE   | SAL     | COMM   | DEPTNO |
+-------+-------+----------+------+------------+---------+--------+--------+
|  7499 | ALLEN | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 |     30 |
+-------+-------+----------+------+------------+---------+--------+--------+

```

查询 1981-02-20 入职的员工(第二种方法，将字符串转换成 date 类型)
```bash
select * from emp where HIREDATE=str_to_date('1981-02-20','%Y-%m-%d');

+-------+-------+----------+------+------------+---------+--------+--------+
| EMPNO | ENAME | JOB      | MGR  | HIREDATE   | SAL     | COMM   | DEPTNO |
+-------+-------+----------+------+------------+---------+--------+--------+
|  7499 | ALLEN | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 |     30 |
+-------+-------+----------+------+------------+---------+--------+--------+

```

### date_format

查询1981-02-20以后入职的员工，将入职日期格式化成yyyy-mm-ddhh:mm:ss
```bash
now() 获得当前时间
select date_format(now(),'%Y-%m-%d %H %i %s');

+----------------------------------------+
| date_format(now(),'%Y-%m-%d %H %i %s') |
+----------------------------------------+
| 2022-04-30 09 37 19                    |
+----------------------------------------+

```

日期格式说明  
%Y:代表 4 位的年份  
%y:代表 2 位的年份  

%m:代表月, 格式为(01......12)  
%c:代表月, 格式为(1......12)  

%H:代表小时,格式为(00......23)  
%h:代表小时,格式为(01......12)  


%i: 代表分钟, 格式为(00......59)  

%r:代表 时间,格式为 12 小时('hh:mm:ss [AP]M')  
%T:代表 时间,格式为 24 小时('hh:mm:ss')  

%S:代表 秒,格式为(00......59)  
%s:代表 秒,格式为(00......59)  


### format

Format(value, bit) 千分位，bit代表保留的小数位  

查询员工薪水加入千分位

```bash
select empno,ename,Format(sal,0) from emp;

+-------+--------+---------------+
| empno | ename  | Format(sal,0) |
+-------+--------+---------------+
|  7369 | SMITH  | 800           |
|  7499 | ALLEN  | 1,600         |
|  7521 | WARD   | 1,250         |
|  7566 | JONES  | 2,975         |
|  7654 | MARTIN | 1,250         |
|  7698 | BLAKE  | 2,850         |
|  7782 | CLARK  | 2,450         |
|  7788 | SCOTT  | 3,000         |
|  7839 | KING   | 5,000         |
|  7844 | TURNER | 1,500         |
|  7876 | ADAMS  | 1,100         |
|  7900 | JAMES  | 950           |
|  7902 | FORD   | 3,000         |
|  7934 | MILLER | 1,300         |
+-------+--------+---------------+

```

### round
 
round(value, bit) 四舍五入，bit代表保留的小数位。    

```bash
select round(123.56);

+---------------+
| round(123.56) |
+---------------+
|           124 |
+---------------+

```

### rand()

生成随机数
```bash
select rand();

+---------------------+
| rand()              |
+---------------------+
| 0.45432951529913534 |
+---------------------+

```

随机抽取记录数
```bash
select * from emp order by rand() limit 2;

+-------+-------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+-------+---------+------+------------+---------+------+--------+
|  7902 | FORD  | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL |     20 |
|  7782 | CLARK | MANAGER | 7839 | 1981-06-09 | 2450.00 | NULL |     10 |
+-------+-------+---------+------+------------+---------+------+--------+

```

### case ... when ... then ...else ... end

如果 job 为 MANAGERG 薪水上涨 10%,如果 job 为 SALESMAN 工资上涨 50%
```bash
select empno, ename, job, sal, case job when 'MANAGER' then sal * 1.1 when 'SALESMAN' then sal * 1.5 end as newsal from emp;

+-------+--------+-----------+---------+---------+
| empno | ename  | job       | sal     | newsal  |
+-------+--------+-----------+---------+---------+
|  7369 | SMITH  | CLERK     |  800.00 |    NULL |
|  7499 | ALLEN  | SALESMAN  | 1600.00 | 2400.00 |
|  7521 | WARD   | SALESMAN  | 1250.00 | 1875.00 |
|  7566 | JONES  | MANAGER   | 2975.00 | 3272.50 |
|  7654 | MARTIN | SALESMAN  | 1250.00 | 1875.00 |
|  7698 | BLAKE  | MANAGER   | 2850.00 | 3135.00 |
|  7782 | CLARK  | MANAGER   | 2450.00 | 2695.00 |
|  7788 | SCOTT  | ANALYST   | 3000.00 |    NULL |
|  7839 | KING   | PRESIDENT | 5000.00 |    NULL |
|  7844 | TURNER | SALESMAN  | 1500.00 | 2250.00 |
|  7876 | ADAMS  | CLERK     | 1100.00 |    NULL |
|  7900 | JAMES  | CLERK     |  950.00 |    NULL |
|  7902 | FORD   | ANALYST   | 3000.00 |    NULL |
|  7934 | MILLER | CLERK     | 1300.00 |    NULL |
+-------+--------+-----------+---------+---------+

```

其他的工资不动，需要添加 else

```bash
select e.*, sal, case job when 'MANAGER' then sal * 1.1 when 'SALESMAN' then sal * 1.5 else sal end as newsal from emp as e;

+-------+--------+-----------+------+------------+---------+---------+--------+---------+---------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO | sal     | newsal  |
+-------+--------+-----------+------+------------+---------+---------+--------+---------+---------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |  800.00 |  800.00 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 | 1600.00 | 2400.00 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 | 1250.00 | 1875.00 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 | 2975.00 | 3272.50 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 | 1250.00 | 1875.00 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 | 2850.00 | 3135.00 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 | 2450.00 | 2695.00 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3000.00 |    NULL |     20 | 3000.00 | 3000.00 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 | 5000.00 | 5000.00 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 | 1500.00 | 2250.00 |
|  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1100.00 |    NULL |     20 | 1100.00 | 1100.00 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |  950.00 |  950.00 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 | 3000.00 | 3000.00 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 | 1300.00 | 1300.00 |
+-------+--------+-----------+------+------------+---------+---------+--------+---------+---------+

```


### ifnull 

select ifnull(comm,0) from emp;  
如果 comm 为 null 就替换为 0  
**在 SQL 语句当中若有 NULL 值参与数学运算，计算结果一定是 NULL 为了防止计算结果出现 NULL，建议先使用 ifnull 空值处理函数预先处理。**   

计算年薪 = (月薪 + 月补助) * 12  

```bash
select e.*, (sal + comm)*12 as yearsal from emp as e;
comm为null,计算出来的年薪为null

+-------+--------+-----------+------+------------+---------+---------+--------+----------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO | yearsal  |
+-------+--------+-----------+------+------------+---------+---------+--------+----------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |     NULL |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 | 22800.00 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 | 21000.00 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |     NULL |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 | 31800.00 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |     NULL |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |     NULL |
|  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3000.00 |    NULL |     20 |     NULL |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |     NULL |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 | 18000.00 |
|  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1100.00 |    NULL |     20 |     NULL |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |     NULL |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |     NULL |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |     NULL |
+-------+--------+-----------+------+------------+---------+---------+--------+----------+

select e.*, (sal + ifnull(comm, 0))*12 as yearsal from emp as e;

+-------+--------+-----------+------+------------+---------+---------+--------+----------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO | yearsal  |
+-------+--------+-----------+------+------------+---------+---------+--------+----------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |  9600.00 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 | 22800.00 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 | 21000.00 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 | 35700.00 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 | 31800.00 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 | 34200.00 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 | 29400.00 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3000.00 |    NULL |     20 | 36000.00 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 | 60000.00 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 | 18000.00 |
|  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1100.00 |    NULL |     20 | 13200.00 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 | 11400.00 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 | 36000.00 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 | 15600.00 |
+-------+--------+-----------+------+------------+---------+---------+--------+----------+
```